<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Interactive Leaves with Shader Background</title>
  <style>
    html, body {
      overflow: hidden;
    }

    canvas.bg {
      display: none;
    }

    .leaf {
      position: absolute;
      width: 30px;
      height: 30px;
      transform-origin: center;
      pointer-events: none;
      opacity: 0.2; /* semi-transparent */
      z-index: -1;
    }

    .leaf svg {
      width: 100%;
      height: 100%;
      display: block;
    }
  </style>
</head>
<body>
  <canvas class="bg"></canvas>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
  <script>
    const leaves = [];
  
    const leafPath = "M15 0 C13 3, 12 5, 12 6 C11 5, 9 5, 8 4 C8 6, 7 7, 6 7 C6 9, 7 10, 8 11 C6 11, 5 12, 4 14 C6 14, 8 13, 10 14 C9 15, 8 16, 8 18 C10 19, 12 18, 13 20 C14 19, 15 17, 15 15 C15 13, 14 11, 13 10 C15 10, 17 11, 18 13 C18 11, 17 9, 16 8 C17 8, 18 7, 19 6 C18 5, 16 4, 15 3 C15 2, 15 1, 15 0 Z";
  
    const colors = ["#D32F2F", "#FFA000", "#FBC02D", "#8D6E63", "#FF7043"];
  
    function createLeaf(x, y, rot, marginSide = null, marginRatio = null) {
      const leaf = document.createElement("div");
      leaf.classList.add("leaf");
  
      const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
      svg.setAttribute("viewBox", "0 0 30 30");
      const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
      path.setAttribute("d", leafPath);
      path.setAttribute("fill", colors[Math.floor(Math.random() * colors.length)]);
      path.setAttribute("stroke", "red");
      path.setAttribute("stroke-width", "0.5");
      svg.appendChild(path);
      leaf.appendChild(svg);
  
      leaf.style.left = `${x}px`;
      leaf.style.top = `${y}px`;
      leaf.dataset.x = x;
      leaf.dataset.y = y;
      leaf.dataset.rotation = rot;
  
      if (marginSide !== null && marginRatio !== null) {
        leaf.dataset.marginSide = marginSide;
        leaf.dataset.marginRatio = marginRatio;
      }
  
      leaf.style.transform = `translate(-50%, -50%) rotate(${rot}deg)`;
      document.body.appendChild(leaf);
      leaves.push(leaf);
  
      if (Math.random() < 0.05) {
        const direction = Math.random() > 0.5 ? "+=3" : "-=3";
        const delay = 2 + Math.random() * 3;
        const duration = 2 + Math.random() * 3;
  
        gsap.to(leaf, {
          rotation: direction,
          yoyo: true,
          repeat: -1,
          duration: duration,
          delay: delay,
          ease: "sine.inOut"
        });
      }
    }
  
    function initializeLeaves() {
      const screenWidth = window.innerWidth;
      const screenHeight = window.innerHeight;
      const leafCount = Math.floor((screenWidth * screenHeight) / 2000);
      const marginThreshold = screenWidth * 0.2;
  
      for (let i = 0; i < leafCount; i++) {
        let x = Math.random() * screenWidth;
        let marginSide = null;
        let marginRatio = null;
  
        if (x > marginThreshold && x < screenWidth - marginThreshold) {
          if (Math.random() < 0.5) {
            marginSide = "left";
            marginRatio = Math.random();
            x = marginThreshold * marginRatio;
          } else {
            marginSide = "right";
            marginRatio = Math.random();
            x = screenWidth - marginThreshold + marginThreshold * marginRatio;
          }
        } else if (x <= marginThreshold) {
          marginSide = "left";
          marginRatio = x / marginThreshold;
        } else {
          marginSide = "right";
          marginRatio = (x - (screenWidth - marginThreshold)) / marginThreshold;
        }
  
        const y = Math.random() * screenHeight;
        const rot = Math.random() * 360;
  
        createLeaf(x, y, rot, marginSide, marginRatio);
      }
    }
  
    function updateLeafPositions() {
      const screenWidth = window.innerWidth;
      const marginThreshold = screenWidth * 0.2;
  
      leaves.forEach(leaf => {
        const marginSide = leaf.dataset.marginSide;
        const marginRatio = parseFloat(leaf.dataset.marginRatio);
        const y = parseFloat(leaf.dataset.y);
        const rot = parseFloat(leaf.dataset.rotation);
        let x;
  
        if (marginSide === "left") {
          x = marginRatio * marginThreshold;
        } else {
          x = screenWidth - marginThreshold + marginRatio * marginThreshold;
        }
  
        leaf.style.left = `${x}px`;
        leaf.dataset.x = x;
      });
    }
  
    initializeLeaves();
    window.addEventListener("resize", updateLeafPositions);
  
    document.addEventListener("mousemove", (e) => {
      leaves.forEach(leaf => {
        const x = parseFloat(leaf.dataset.x);
        const y = parseFloat(leaf.dataset.y);
        const r = parseFloat(leaf.dataset.rotation);
  
        const dx = e.clientX - x;
        const dy = e.clientY - y;
        const dist = Math.sqrt(dx * dx + dy * dy);
  
        if (dist < 100) {
          const angle = Math.atan2(dy, dx);
          const tx = x - Math.cos(angle) * 30;
          const ty = y - Math.sin(angle) * 30;
          const tr = r + 45;
  
          gsap.to(leaf, {
            duration: 0.8,
            ease: "sine.out",
            x: tx - x,
            y: ty - y,
            rotation: tr
          });
        } else {
          gsap.to(leaf, {
            duration: 1.2,
            ease: "sine.out",
            x: 0,
            y: 0,
            rotation: r
          });
        }
      });
    });
  </script>
  
</body>
</html>
